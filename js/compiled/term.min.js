var inheritsFrom=function(a,b){a.prototype=Object.create(b.prototype)},termCmd=function(){};termCmd.prototype.execute=function(){};var HTMLCmd=function(a){this.txt=a},RemoveCmd=function(a){this.tag=a},BuiltInCmd=function(a){this.command=a},CompositeCmd=function(a,b){this.name=a;this.cmdList=[];this.cmdList.push(b)};inheritsFrom(HTMLCmd,termCmd);inheritsFrom(RemoveCmd,termCmd);inheritsFrom(BuiltInCmd,termCmd);inheritsFrom(CompositeCmd,termCmd);
HTMLCmd.prototype.execute=function(){add_to_div("<br>"+this.txt)};BuiltInCmd.prototype.execute=function(){this.command()};RemoveCmd.prototype.execute=function(){var a=$("cmd[remove-cmd='"+this.tag+"']");console.log(a);a.remove()};CompositeCmd.prototype.execute=function(){i=0;for(max=this.cmdList.length;i<max;i++)this.cmdList[i].execute()};var prompt="",cmds={},version_="webterminal v0.3.0",errmsg="</br></br><div id='err'>Sorry</div> that is not valid command, refer to the valid commads below.",version_info="</br></br>"+version_+"</br>This version is still in beta with many features still to be implemented. Source code can be viewed <a target='_blank' href='http://www.github.com/farazoman/terminal_webapp'>here</a></br>",cmd="",endline="</br>",blinkerOn=!1,inFocus=!1,remove_attr="remove-cmd",cmd_history=[],hist_pos=0,cmd_text_tag="cmd_text";
function load(a){for(var b=document.getElementById("term_area"),g=document.getElementsByTagName("body"),d=document.getElementsByTagName("cmd"),c=0,k=d.length;c<k;c++){var e=d[c].getAttribute("name"),f=d[c].getAttribute(remove_attr),h=new HTMLCmd(d[c].innerHTML);e||(e=c+"");f&&(cmds[f]=new RemoveCmd(f),h=new HTMLCmd("<cmd "+remove_attr+"="+f+">"+d[c].innerHTML+"</cmd>"));cmds[e]=new CompositeCmd(e,h)}cmds.version=new BuiltInCmd(version);cmds.help=new BuiltInCmd(ayuda);cmds.clear=new BuiltInCmd(clear);
b.innerHTML="";add_to_div(b.getAttribute("welcome"));prompt=endline+a;add_prompt();setInterval(function(){blinker()},500);b.addEventListener("click",setInFocus,!1);g[0].addEventListener("click",setOutOfFocus)}function setInFocus(){inFocus=!0;$("#term_area").focus()}function setOutOfFocus(a){"term_area"==a.target.id?setInFocus():inFocus=!1}function nada(){}function add_to_div(a,b){(void 0===b?0:b)?$("#term_area").append(a):$("#term_area").append("<span>"+a+"</span>")}
function update_cmd(a){void 0!=a&&(cmd=a,$("#term_area "+cmd_text_tag+":last-child").html(cmd))}function add_prompt(){add_to_div(prompt);add_to_div("<"+cmd_text_tag+"></"+cmd_text_tag+">",!0)}var version=function(){add_to_div(version_info)};function resume(){window.open("http://www.farazoman.com/files/cur_resume.pdf","_blank")}
var clear=function(){document.getElementById("term_area").innerHTML=""},ayuda=function(){var a="</br></br><u>The available commands are:</u>";for(i in cmds)a+=endline,a+=i;add_to_div(a)};function error(){add_to_div(errmsg);ayuda()}function turnOffBlinker(){backspace(!0);blinkerOn=!1}function blinker(){var a="";inFocus?(blinkerOn?turnOffBlinker():(a+="<blink>|</blink>",blinkerOn=!0),add_to_div(a,!0)):turnOffBlinker()}
function add_to_hist(a){""!=a&&cmd_history.unshift(a);hist_pos=0;console.log(cmd_history)}document.addEventListener("keypress",function(a){var b=document.getElementById("term_area");if(inFocus){if(13==a.keyCode){backspace(!0);console.log(cmd);add_to_hist(cmd);try{cmd?cmds[cmd].execute():nada()}catch(g){error()}backspace(!0);cmd="";add_prompt()}else 38!=a.keyCode&&40!=a.keyCode&&(a=String.fromCharCode(a.keyCode),turnOffBlinker(),update_cmd(cmd+=a));b.scrollTop=b.scrollHeight}});var isUp=!1;
window.addEventListener("keydown",function(a){switch(a.keyCode){case 38:hist_pos<cmd_history.length&&0<=hist_pos&&(turnOffBlinker(),update_cmd(cmd_history[hist_pos]),console.log(cmd_history[hist_pos]),hist_pos+=1,isUp=!0);break;case 40:--hist_pos,isUp&&(isUp=!1,--hist_pos),0>hist_pos?(a="",hist_pos=0):a=cmd_history[hist_pos],turnOffBlinker(),update_cmd(a)}},!1);
function backspace(a){blinkerOn&&a&&($("#term_area blink:last-child").remove(),blinkerOn=!1);0==cmd.length||a||($("#term_area blink:last-child").remove(),update_cmd(cmd.substring(0,cmd.length-1)))}
$(document).unbind("keydown").bind("keydown",function(a){var b=!1;if(8===a.keyCode||38===a.keyCode||40===a.keyCode)b=a.srcElement||a.target,b="INPUT"===b.tagName.toUpperCase()&&("TEXT"===b.type.toUpperCase()||"PASSWORD"===b.type.toUpperCase()||"FILE"===b.type.toUpperCase()||"EMAIL"===b.type.toUpperCase()||"SEARCH"===b.type.toUpperCase()||"DATE"===b.type.toUpperCase())||"TEXTAREA"===b.tagName.toUpperCase()?b.readOnly||b.disabled:!0,8===a.keyCode&&(backspace(!1),turnOffBlinker());b&&a.preventDefault()});